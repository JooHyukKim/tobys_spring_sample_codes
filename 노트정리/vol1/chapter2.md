## 2장

> "항상 스프링 컨테이너 없이 테스트할 수 있는 방법을 가장 우선적으로 고려하자."
>
> - 토비,  "토비의 스프링 vol.1 페이지 196"
>
> > 이 방법이 테스트 수행 속도가 가장 빠르고 테스트 자체가 간결하다. 테스트를 위해 필요한 오브젝트의 생성과 초기화가 단순하다면 이 방법을 가장 먼저 고려해야한다.

- 토비가 생각하는 스프링의 가장 큰 장점은 IoC/DI 와 테스트이다.
- 스프링의 창시자인 로드 존슨은 항상 네거티브 테스트를 먼저만들라는 조언을 했다 .
- 그래서 항상 부정적인 테스트를 먼저 만들어야 테스트에서 더 많은 결과를 얻어낼 수 있을 것이다.
- 테스트 설정을 따로 만들었다고 하더라도 때로는 예외적인 의존관계를 강제로 구성해서 테스트해야 할 경우가 있다.
    - 이때는 컨텍스트에서 DI 받은 오브젝트에 다시 테스트 코드로 수동 DI 해서 테스트하는 방법을 사용하면 된다.
    - 테스트 코드나 클래스에 @DirtiesContext 애노테이션을 붙이는 것을 잊지 말자.

### 2.5. 학습 테스트로 배우는 스프링

- 학습 테스트의 목적은 자신이 사용할 API나 프레임워크의 기능을 테스트로 보면서 익히는 것이다.

### 2.5.1. 학습 테스트의 장점

- 다양한 조건에 따른 기능을 손쉽게 확인해볼 수 있다.
- 학습 테스트 코드를 개발 중에 참고할 수 있다.
- 프레임워크나 제품을 업그레이드할 때 호환성 검증을 도와준다.
- 테스트 작성에 대한 좋은 훈련이 된다.
- 새로운 기술을 공부하는 과정이 즐거워 진다.

### 2.5.3. 버그테스트

- 버그 발생시 테스트 케이스를 먼저 만드는 것이 유용하다.
    - 버그가 원인이 되서 테스트가 실패하는 케이스를 만들어 두고
    - 버그 테스트가 성공할 수 있도록 코드를 수정한다.
- 테스트의 완성도를 높혀준다.
- 버그의 내용을 명확하게 분석하게 해준다.
- 기술적인 문제를 해결하는 데 도움이 된다.
- 동등분할 : 같은 결과를 내는 값들을 구분해서 각 대표값으로 테스트하는 방법.
    - 예를들어 true, false, 실패하는 세가지 케이스가 있다면 3가지 모두의 테스트를 만든다.
- 경계값 분석
    - 에러는 동등분할 범위의 경계에서 주로 많이 발생한다는 특징을 이용해서 경계 근처에 있는 값을 이용해 테스트하는 방법이다

### 2.6. 정리

- 테스트는 자동화돼야 하고 빠르게 실행할 수 있어야한다.
- main 테스트 대신 JUnit 프레임워크를 이용한 테스트 작성이 편리하다.
- 테스트 결과는 일관성이 있어야 한다.
- 코드의 변경 없이 환경이나 테스트 실행 순서에 따라서 결과가 달라지면 안된다.
- 테스트는 포괄적으로 작성해야 한다. 충분한 검증을 하지 않는 테스트는 없는 것보다 나쁠 수 있다.
- 코드 작성과 테스트 수행의 간격이 짧을 수록 효과적이다.
- 테스트하기 쉬운 코드가 좋은 코드다.
- 테스트를 먼저 만들고 테스트를 성공시키는 코드를 만들어가는 테스트 주도 개발 방법도 유용하다.
- 테스트코드도 애플리케이션 코드와 마찬가지로 적절한 리팩토링이 필요하다.
- @Before @After 를 사용해서 테스트 메소드들의 공통 준비 작업과 정리 작업을 처리할 수 있다.
- 스프링 테스트 컨텍스트 프레임워크를 이용하면 테스트 성능을 향상시킬 수 있다
- 동일한 설정파일을 사용하는 테스트는 하나의 애플리케이션 컨텍스트를 공유한다.
- @Autowired를 사용하면 컨텍스트의 빈을 테스트 오브젝트에 DI 할 수 있다.
- 기술의 사용방법을 익히고 이해를 돕기 위해 학습 테스트를 작성하자.
- 오류가 발견될 경우 그에 대한 버그 테스트를 만들어두면 유용하다.

>> 스프링을 사용하는 개발자라면 자신이 만든 코드를 테스트로 검증하는 방법을 알고 있어야 하며, 테스트를 개발에 적극적으로 활용할 수 있어야 한다. 
